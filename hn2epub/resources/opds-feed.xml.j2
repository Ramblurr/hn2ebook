<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xmlns:dcterms="http://purl.org/dc/terms/">
  <id>urn:uuid:dd7c6971-ed68-4372-8e0d-77b1d28f2b54</id>
  <updated>{{ current_time }}</updated>
  <link rel="self"
        href="{{ feed_url }}"
        type="application/atom+xml;profile=opds-catalog;type=feed;kind=navigation"/>
  <link rel="start"
        href="{{start_url}}"
        type="application/atom+xml;profile=opds-catalog;type=feed;kind=navigation"/>
  <link rel="up"
        href="{{up_url}}"
        type="application/atom+xml;profile=opds-catalog;type=feed;kind=navigation"/>
  <title>{{instance}}</title>
  <author>
    <name>{{instance}}</name>
    <uri>{{ instance_url }}</uri>
  </author>

  {% if entries and entries[0] %}
  {% for entry in entries %}
  <entry>
    <title>{{entry.title}}</title>
    <id>{{entry.id}}</id>
    <updated>{{entry.atom_timestamp}}</updated>
    {% if entry.authors.__len__() > 0 %}
      <author>
        <name>{{entry.authors[0].name}}</name>
      </author>
    {% endif %}
    {% if entry.publishers.__len__() > 0 %}
      <publisher>
        <name>{{entry.publishers[0].name}}</name>
      </publisher>
    {% endif %}
    <dcterms:language>{{entry.language}}</dcterms:language>
    <summary>{{summary|striptags}}</summary>
    {% if entry.has_cover %}
    <link type="image/jpeg" href="{{ entry.cover_url }}" rel="http://opds-spec.org/image"/>
    <link type="image/jpeg" href="{{ entry.cover_url }}" rel="http://opds-spec.org/image/thumbnail"/>
    {% endif %}
    {% for format in entry.formats %}
    <link rel="http://opds-spec.org/acquisition" href="{{format.url}}"
          length="{{format.size}}" mtime="{{entry.atom_timestamp}}" type="{{format.mimetype}}"/>
    {% endfor %}
  </entry>
  {% endfor %}
  {% endif %}
</feed>
